\part{Thermodynamics}

\chapter{The 2 laws, which are 4}

    In this chapter, we will recall some notions of thermodynamics: states, equilibrium and the laws of thermodynamics.

\section{Equilibrium}

    The topic of which thermodynamics studies is a class of systems composed by a large amount of particles, roughly speaking Avogadro number $N_A \simeq 6 \times 10^{23}$ constituents, once it reaches a macroscopic equilibrium configuration. To understand the notion of equilibrium, consider a system immersed in its surroundings. It can either interact with it by exchanging matter and/or energy (mechanical, electric, magnetic, chemical work) or be completely isolated. Once a sufficient amount of time has passed By, it reaches a stable configuration. Which particular configuration and its stability can be selected by different boundary conditions the system finds itself in, i.e.~the specification on how the system is in contact and how it interacts with its surroundings. In other words, there is only one and only one final equilibrium configuration towards to the system evolves, once boundary conditions have been given. However, the way the system reaches the equilibrium configuration is irreversible. Equilibrium therefore means that once the system has reached its final configuration, it will stay there forever. 

\section{States}

    A state is a macroscopic configuration. Mathematically speaking, it is a point in the manifold $\mathcal M$ of thermodynamic states. To describe it, we need a chart given by macroscopic physical quantities, called thermodynamic variables. They can be divided into two groups, one conjugate to the other, according to their behaviour when the physical system is rescaled, i.e.~when volume and number of particles change: extensive variables do scale with it whereas intensive ones do not. Some of them are written in Table~\ref{table:td:1}. However, we have to be careful, since only volume is (by definition) extensive and all the others quantities can be considered extensive only if the surface terms are negligible when we take the thermodynamic limit, i.e.~when we first describe the system with finite volume $V$ and number of particles $N$ and then we go to the limit in which $V \rightarrow \infty$ and $N \rightarrow \infty$ but keeping the density fixed $n = N / V$.

    Each physical system has an equation of state, i.e.~a functional relation among thermodynamic quantities which restrict the number of independent variables. Geometrically, it means that the only admissible states are a submanifold $\mathcal A \subset \mathcal M$ of the entire manifold of states, given by the constraint induced by the equation of state.

    \begin{example}[Perfect gas]
        Consider a perfect gas. A chart on its $3$-dimensional manifold can be $(p, V, T)$ and its equation of state is $PV = N k_B T$. This means that the allowed states are in a $2$-dimensional manifold embedded in $\mathbb R^3$.
    \end{example}

    \begin{table}[h!]
        \centering
        \begin{tabular}{c | c }
            Extensive & Intensive \\
            \hline
            energy $E$ & - \\ 
            entropy $S$ & temperature $T$ \\ 
            volume $V$ & pressure $p$\\ 
            number of particles $N$ & chemical potential $\mu$ \\ 
            polarization $\mathbf P$ & electric field $\mathbf E$ \\ 
            magnetization $\mathbf M$ & magnetic field $\mathbf B$ \\ 
        \end{tabular}
        \caption{Extensive and intensive thermodynamic variables.}
        \label{table:td:1}
    \end{table}

\section{The laws of thermodynamics}

    Thermodynamics is governed by a set of laws that every system must obey. They are a particular kind of laws, since they are limitation laws: they tell us only which processes cannot happen. Usually they are referred as the two laws of thermodynamics, but actually they are $4$.

    \begin{law}[0th]
        Let $A$ and $B$ be two thermodynamic systems in thermal contact. At equilibrium, only a subset of states $\mathcal A \subset \mathcal M_A \times \mathcal M_B$ is accessible and not the whole manifold. Mathematically, it means that there exists a functional relation of the kind
        \begin{equation}\label{td:proof1}
            F_{AB} (a,b)= 0 ~,
        \end{equation}
        with $a \in \mathcal M_A$ and $b \in \mathcal M_B$. Moreover, thermal equilibrium is an equivalence class, which can be proved that it means 
        \begin{equation}\label{td:proof2}
            F_{AB} (a,b) = f_A(a) - f_B(b) ~.
        \end{equation}
        The combination of both~\eqref{td:proof1} and~\eqref{td:proof2} allows us to define the empirical temperature 
        \begin{equation}\label{td:0th}
            t_A = f_A(a) = t_B = f_B(b) ~.
        \end{equation}\myequation{0th law of thermodynamic}
    \end{law}
    \noindent It is a limitation law because it limits the configuration that a system can reach in isolation when it is in thermal contact with a second one. 

    \begin{law}[1st]
        Let $\delta Q$ be an infinitesimal heat and $\delta L$ an infinitesimal work exchanged in a quasi-static process ($\delta Q > 0$ means absorbed by the system, $\delta L > 0$ means performed by the system). For any cyclic process, i.e.~processes in which the initial and the final states coincide, we have
        \begin{equation*}
            \oint (\delta Q - \delta L) = 0 ~.
        \end{equation*}
        This means that $\delta Q - \delta L$ is a $1$-form that vanishes when line-integrated along a closed curve in $\mathcal M$ and, by the Poincar√© lemma, it is also an exact differential, called the internal energy
        \begin{equation*}
            dE = \delta Q - \delta L ~,
        \end{equation*}
        However, heat and work are not exact differential, since $\oint \delta Q \neq 0$ and $\oint \delta H \neq 0$. 
        
        The generalisation for a system that can exchange matter is given by
        \begin{equation}\label{td:1st}
            \oint (\delta Q - \delta L + \mu dN) = \oint dE = 0 ~, \quad dE = \delta Q - \delta L + \mu dN ~,
        \end{equation}\myequation{1st law of thermodynamic}
        where $\mu$ is the chemical potential, i.e.~the necessary energy to add or remove a particle. Furthermore, we can express both $\delta Q$ and $\delta L$ as a linear combination of infinitesimal change of independent coordinates, e.g. $\delta L = p dV + B dM$. In the following, the only work considered will be the mechanical one $\delta L = p dV$. We assume that the internal energy is extensive and, therefore, the chemical potential is intensive.
    \end{law}

    It is a limitation law because it limits the configuration that a system can reach in isolation to those with $E = const$. 

    \begin{law}[2nd]
        For any cyclic process, we have
        \begin{equation*}
            \oint \frac{\delta Q}{T} \begin{cases}
                = 0 & \textnormal{reversible process} \\
                < 0 & \textnormal{irreversible process} \\
            \end{cases} ~.
        \end{equation*}
        For reversible processes, $\frac{\delta Q}{T} = 0$ is an exact differential. This implies that we can define a function, called entropy, which is always integrated along any reversible path
        \begin{equation}\label{td:2nde}
            S(a) - S(b) = \int_a^b \frac{\delta Q}{T} ~,
        \end{equation}
        Therefore, we have  
        \begin{equation}\label{td:2nd}
            dS \begin{cases}
                = 0 & \textnormal{reversible process} \\
                < 0 & \textnormal{irreversible process} \\
            \end{cases} ~.
        \end{equation}\myequation{2nd law of thermodynamic}
    \end{law}

    It is a limitation law because it limits the configuration that a system can reach in isolation to whose in which entropy cannot increase. 

    \begin{law}[3rd]
        Isothermal and adiabatic processes coincides when $T=0$, or, equivalently, it is impossible to reach $T=0$ with a finite number of processes. Mathematically,
        \begin{equation}\label{td:3rd}
            \Delta S \rightarrow 0 ~\textnormal{as}~ T \rightarrow 0 ~.
        \end{equation}\myequation{3rd law of thermodynamic}
        Therefore, $T=0$ is a singular point. Furthermore, if it were possible to reach $T=0$, the second law $\delta Q \leq 0$ implies that it is impossible to raise the temperature. It is a thermodynamic feature, since it can be proved that it is impossible to realize an engine with efficiency $\eta = 1$.
    \end{law}

    It is a limitation law because it limits the configuration that a system can reach in isolation to whose in which $T \neq 0$.

\chapter{Thermodynamic potentials}

    In this chapter, we will study thermodynamic potentials: energy $E$, entropy $S$, Helmholtz free energy $F$, enthalpy, Gibbs free energy and grand potential. We will derive their definition, their differential and their equations of state. 
    
    Thermodynamic potentials are functions defined in the manifold, which are suited for a particular choice of the $3$ coordinates (boundary conditions) and, therefore, they are useful if we find the system with all the other coordinates constant. 
    
\section{Internal energy}
    
    The first thermodynamic potential we are going to study is the internal energy $E$, which is defined by the first law of thermodynamic~\eqref{td:1st}. Its differential is
    \begin{equation}\label{td:d:e}
        dE \leq T dS - pdV + \mu dN ~.
    \end{equation}
    This relation is called the fundamental equation of thermodynamics.
    \begin{proof}
        In fact, we invert~\eqref{td:1st}
        \begin{equation*}
            \delta Q = dE + \delta L - \mu dN ~,
        \end{equation*}
        we use $\delta L = p dV$ and we put it into~\eqref{td:2nd}
        \begin{equation}
            dS \leq \frac{\delta Q}{T} = \frac{dE + p dV - \mu dN}{T} ~.
        \end{equation}
        Finally, we isolate $dE$
        \begin{equation}
            dE \leq TdS - p dV + \mu dN ~.
        \end{equation}
    \end{proof} 

    Notice that non-differential variables are intensive and differential one are extensive. This tells us that $E(S, V, N)$ is a function of the extensive variables $S$, $V$ and $N$. The intensive variables $T$, $p$ and $\mu$ can be derived from $E$ by the following relations 
    \begin{equation}\label{td:es:e}
        T = \pdv{E}{S} \Big \vert_{V,N} ~, \quad p = - \pdv{E}{V} \Big \vert_{S,N} ~, \quad \mu = \pdv{E}{N} \Big \vert_{S,V} ~. 
    \end{equation}
    These functional relations are called the equation of state of the system, since we can calculate one variable from it, e.g. $T = T(S,V,N)$, $p = p(S,V,N)$ or $\mu = \mu(S,V,N)$. 
    \begin{proof}
        At constant $V$ and $N$,~\eqref{td:d:e} becomes
        \begin{equation*}
            dE = TdS - p \underbrace{dV}_0 + \mu \underbrace{dN}_0 = TdS ~,
        \end{equation*}
        hence 
        \begin{equation*}
            T = \pdv{E}{S} \Big \vert_{V,N} ~.
        \end{equation*}
        At constant $S$ and $N$,~\eqref{td:d:e} becomes
        \begin{equation*}
            dE = T\underbrace{dS}_0 - p dV + \mu \underbrace{dN}_0 = - p dV ~,
        \end{equation*}
        hence 
        \begin{equation*}
            p = - \pdv{E}{V} \Big \vert_{S,N} ~.
        \end{equation*}
        At constant $S$ and $V$,~\eqref{td:d:e} becomes
        \begin{equation*}
            dE = T\underbrace{dS}_0 - p \underbrace{dV}_0 + \mu dN = \mu dN ~,
        \end{equation*}
        hence 
        \begin{equation*}
            \mu = \pdv{E}{S} \Big \vert_{S,V} ~.
        \end{equation*}
    \end{proof}

    $E$ is an extensive variable, i.e. it is an homogeneous function of degree one of the extensive variables 
    \begin{equation}\label{td:omoe}
        E(\lambda S, \lambda V, \lambda N) = \lambda E(S, V, N) ~, \quad \forall \lambda > 0 ~.
    \end{equation}
    The physical meaning is that if we rescale the volume, the energy is rescaled by the same amount. Moreover, since energy is an homogeneous function of degree one of extensive variables and intensive variables are derivative of the energy with respect to extensive variables, we can conclude that intensive variable are homogeneous function of degree zero of the extensive variables 
    \begin{equation}\label{a5}
    \begin{gathered}
        T(S, V, N) = T \Big(\frac{S}{N}, \frac{V}{N} \Big) ~, \quad p(S, V, N) = p \Big (\frac{S}{N}, \frac{V}{N} \Big) ~, \\ \mu(S, V, N) = \mu \Big(\frac{S}{N}, \frac{V}{N} \Big) ~.
    \end{gathered}
    \end{equation}
    By homogeneity properties~\eqref{td:omoe}, using $\lambda = N$, we can therefore write
    \begin{equation*}
    \begin{gathered}
        E = E(S, V, N) = E \Big(N \frac{S}{N}, N \frac{V}{N}, N \Big) = N E \Big(\frac{S}{N}, \frac{V}{N}, 1 \Big) = N e ~, \\  S = S(E, V, N) = S \Big(N \frac{E}{N}, N \frac{V}{N}, N \Big) = N S \Big(\frac{E}{N}, \frac{V}{N}, 1 \Big) = N s ~,
    \end{gathered}
    \end{equation*}
    where we have defined specific energy $e$, specific entropy $s$ and specific volume $v$ as
    \begin{equation*}
        e = \frac{E}{N} = e(s, v) ~, \quad s = \frac{S}{N} = s(e, v) ~, \quad v = \frac{V}{N} ~.
    \end{equation*}
    The Euler's theorem allows us to state that, if $E$ is smooth, it can be written as 
    \begin{equation*}
        E = S \pdv{E}{S} + V \pdv{E}{V} + N \pdv{E}{N} ~,
    \end{equation*}
    or, equivalently, 
    \begin{equation}\label{td:e}
        E = TS - pV + \mu N ~.
    \end{equation}
    \begin{proof}
        In fact, using~\eqref{td:es:e}, we obtain
        \begin{equation*}
            E = S \underbrace{\pdv{E}{S}}_T + V \underbrace{\pdv{E}{V}}_{-p} + N \underbrace{\pdv{E}{N}}_\mu = TS - pV + \mu N ~.
        \end{equation*}
    \end{proof}

    In order to be an exact differential, the exterior derivative of the right-handed side of~\eqref{td:d:e} must have a null exterior derivative, which leads to the integrability conditions
    \begin{equation}\label{td:int:e}
        - \pdv{T}{V} \Big \vert_{S,N} = \pdv{p}{S} \Big \vert_{V,N} ~, \quad 
        \pdv{T}{N} \Big \vert_{S,V} = \pdv{\mu}{S} \Big \vert_{N, V} ~, \quad 
        - \pdv{p}{N} \Big \vert_{V,S} = \pdv{\mu}{V} \Big \vert_{N, S} ~. 
    \end{equation}
    \begin{proof}
        By means of the exterior derivative, we have 
        \begin{equation*}
        \begin{aligned}
            d (dE) & = d (T dS) - d (p dV) + d (\mu dN) \\ & = \pdv{T}{S} \underbrace{dS \wedge dS}_0 + \pdv{T}{V} dV \wedge dS + \pdv{T}{N} dN \wedge dS - \pdv{p}{S} dS \wedge dV - \pdv{p}{V} \underbrace{dV \wedge dV}_0 \\ & \quad - \pdv{p}{N} dN \wedge dV + \pdv{\mu}{S} dS \wedge dN + \pdv{\mu}{V} dV \wedge dN + \pdv{\mu}{N} \underbrace{dN \wedge dN}_0 \\ & = \pdv{T}{V} dV \wedge dS + \pdv{T}{N} dN \wedge dS - \pdv{p}{S} dS \wedge dV \\ & \quad - \pdv{p}{N} dN \wedge dV + \pdv{\mu}{S} dS \wedge dN + \pdv{\mu}{V} dV \wedge dN ~.
        \end{aligned}
        \end{equation*}
        At constant $N$, we obtain
        \begin{equation*}
        \begin{aligned}
            0 & = d^2 E = \pdv{T}{V} dV \wedge dS + \pdv{T}{N} \underbrace{dN}_0 \wedge dS - \pdv{p}{S} dS \wedge dV \\ & \quad - \pdv{p}{N} \underbrace{dN}_0 \wedge dV + \pdv{\mu}{S} dS \wedge \underbrace{dN}_0 + \pdv{\mu}{V} dV \wedge \underbrace{dN}_0 \\ & = \pdv{T}{V} dV \wedge dS - \pdv{p}{S} dS \wedge dV = \pdv{T}{V} dV \wedge dS + \pdv{p}{S} dV \wedge dS ~,
        \end{aligned}
        \end{equation*}
        hence, by the linear independence of $V$ and $S$, we find
        \begin{equation*}
            - \pdv{T}{V} \Big \vert_{S,N} = \pdv{p}{S} \Big \vert_{V,N} ~.
        \end{equation*}
        At constant $V$, we obtain
        \begin{equation*}
        \begin{aligned}
            0 & = d^2 E = \pdv{T}{V} \underbrace{dV}_0 \wedge dS + \pdv{T}{N} dN \wedge dS - \pdv{p}{S} dS \wedge \underbrace{dV}_0 \\ & \qquad - \pdv{p}{N} dN \wedge \underbrace{dV}_0 + \pdv{\mu}{S} dS \wedge dN + \pdv{\mu}{V} \underbrace{dV}_0 \wedge dN \\ & = \pdv{T}{N} dN \wedge dS + \pdv{\mu}{S} dS \wedge dN = \pdv{T}{N} dN \wedge dS - \pdv{\mu}{S} dN \wedge dS~,
        \end{aligned}
        \end{equation*}
        hence, by the linear independence of $N$ and $S$, we find
        \begin{equation*}
            \pdv{T}{N} \Big \vert_{S,V} = \pdv{\mu}{S} \Big \vert_{N, V} ~.
        \end{equation*}
        At constant $S$, we obtain
        \begin{equation*}
        \begin{aligned}
            0 & = d^2 E = \pdv{T}{V} dV \wedge \underbrace{dS}_0 + \pdv{T}{N} dN \wedge \underbrace{dS}_0 - \pdv{p}{S} \underbrace{dS}_0 \wedge dV \\ & \qquad - \pdv{p}{N} dN \wedge dV + \pdv{\mu}{S} \underbrace{dS}_0 \wedge dN + \pdv{\mu}{V} dV \wedge dN \\ & = - \pdv{p}{N} dN \wedge dV + \pdv{\mu}{V} dV \wedge dN = - \pdv{p}{N} dN \wedge dV - \pdv{\mu}{V} dN \wedge dV ~,
        \end{aligned}
        \end{equation*}
        hence, by the linear independence of $N$ and $V$, we find
        \begin{equation*}
            - \pdv{p}{N} \Big \vert_{V,S} = \pdv{\mu}{V} \Big \vert_{N, S} ~.
        \end{equation*}
    \end{proof}

\section{Entropy}

    The second thermodynamic potential we are going to study is the entropy $S$. Inverting~\eqref{td:d:e}, we obtained its differential
    \begin{equation}\label{td:d:s}
        dS = \frac{1}{T} dE + \frac{p}{T} dV - \frac{\mu}{T} dN ~.
    \end{equation}
    Therefore, its equations of state are 
    \begin{equation}\label{td:es:s}
        \frac{1}{T} = \pdv{S}{E} \Big \vert_{V, N} ~, \quad \frac{p}{T} = \pdv{S}{V} \Big \vert_{E, N} ~, \quad - \frac{\mu}{T} = \pdv{S}{N} \Big \vert_{E, V} ~.
    \end{equation}

    The Gibbs-Duhem relation expresses the chemical potential $\mu$ in terms of the pressure $p$ and the temperature $T$ 
    \begin{equation}\label{td:gd}
        S dT - Vdp + N d\mu = 0 ~, \quad d \mu = v dp - s dT ~.
    \end{equation}
    \begin{proof}
        Computing the differential of~\eqref{td:e} 
        \begin{equation*}
            dE = T dS + S dT -p dV + \mu dN + N d\mu 
        \end{equation*}
        and comparing it with~\eqref{td:d:e}
        \begin{equation*}
            dE = \cancel{T dS} + S dT - \cancel{p dV} + - V dp + \cancel{\mu dN} + N d\mu = \cancel{T dS} - \cancel{p dV} + \cancel{\mu dN} ~,
        \end{equation*}
        we obtain 
        \begin{equation*}
            S dT - V dp + N d\mu = 0 ~,
        \end{equation*}
        which can be written as 
        \begin{equation*}
            d \mu = \frac{V}{N} dp - \frac{S}{N} dT = v dp - s dT ~.
        \end{equation*}
    \end{proof}

\section{Thermodynamic states as a manifold}

    Since an equilibrium state is a point in the manifold $\mathcal M$, we need a chart to describe it, which in our case can be thought as an open subset of $\mathbb R^3$. An example of independent local coordinates are $S$, $V$ and $N$ and they can be used to solve thermodynamic, i.e.~to find explicitly the fundamental equation 
    \begin{equation}\label{td:coord:e}
        E = E(S, V, N) ~.
    \end{equation}
    However, we could have chosen another thermodynamic potential, like the entropy
    \begin{equation}\label{td:coord:s}
        S = S(E, V, N) 
    \end{equation}
    and a chart would have had $E$, $V$ and $N$ as coordinates. Notice that at least one of the local coordinates in any chart for $\mathcal M$ must always be extensive. 
    \begin{proof}
        By the $0th$ law and~\eqref{a5}, there must exist a functional relation between intensive variables. This means that one of the three is already fixed once the other two are given and they cannot be used all three as independent coordinates.
    \end{proof}
    Therefore, there are different thermodynamic potentials that we can use: all functions of $3$ independent variables (of which one at least must be extensive) that can be used to define a different chart for $\mathcal M$. This implies that there are different approaches to thermodynamics. The standard method to find other potentials is to apply various kind of Legendre transform of~\eqref{td:d:e}, which exchanges the role of an extensive variable to its conjugate intensive variable as independent variable. The only requirement we need is that the hypothesis of the inverse function theorem are satisfied, e.g. 
    \begin{equation*}
        \pdvdu{E}{S} \Big \vert_{V,N} \neq 0 ~, \quad \pdvdu{E}{V} \Big \vert_{S,N} \neq 0 ~, \quad \pdvdu{E}{N} \Big \vert_{S, V} \neq 0 ~.
    \end{equation*}
    In the next sections, we will study the most important in thermodynamics: Helmholtz free energy $F$, enthalpy $H$, Gibbs free energy $G$ and grand potential $\Omega$.

\section{Helmholtz free energy} 

    The Helmholtz free energy is defined as 
    \begin{equation}\label{td:def:f}
        F = E - TS ~.
    \end{equation}
    Its differential is 
    \begin{equation}\label{td:d:f}
        dF \leq - S dT - p dV + \mu dN ~.
    \end{equation}
    Its associated chart is
    \begin{equation}\label{td:coord:f}
        F = F(T, V, N) ~.
    \end{equation}
    \begin{proof}
        By a Legendre transform, which means to complete a differential, we obtain
        \begin{equation*}
            dE \leq T dS - p dV + \mu dN = d(TS) - S dT - p dV + \mu dN ~,
        \end{equation*}
        hence,
        \begin{equation*}
            dF = d(E - TS) \leq - S dT - p dV + \mu dN ~.
        \end{equation*}
    \end{proof}
    The equations of state are
    \begin{equation}\label{td:es:f}
        S = - \pdv{F}{T} \Big \vert_{V,N} ~, \quad p = - \pdv{F}{V} \Big \vert_{T,N} ~, \quad \mu = \pdv{F}{N} \Big \vert_{T,V} ~. 
    \end{equation}
    \begin{proof}
        At constant $V$ and $N$, we have
        \begin{equation*}
            dF = - S dT - p \underbrace{dV}_0 + \mu \underbrace{dN}_0 = - S dT~,
        \end{equation*}
        hence,
        \begin{equation*}
            S = - \pdv{F}{T} \Big \vert_{V,N} ~.
        \end{equation*}
        At constant $T$ and $N$, we have
        \begin{equation*}
            dF = - S \underbrace{dT}_0 - p dV + \mu \underbrace{dN}_0 = - pdV ~,
        \end{equation*}
        hence,
        \begin{equation*}
            p = - \pdv{F}{V} \Big \vert_{T,N} ~.
        \end{equation*}
        At constant $T$ and $V$, we have
        \begin{equation*}
            dF = - S \underbrace{dT}_0 - p \underbrace{dV}_0 + \mu dN = \mu dN~,
        \end{equation*}
        hence,
        \begin{equation*}
            \mu = \pdv{F}{N} \Big \vert_{T,V} ~.
        \end{equation*}
    \end{proof}
    The integrability conditions are 
    \begin{equation}\label{td:int:f}
        \pdv{S}{V} \Big \vert_{T,N} = \pdv{p}{T} \Big \vert_{V,N} ~, \quad 
        - \pdv{S}{N} \Big \vert_{T,V} = \pdv{\mu}{T} \Big \vert_{N, V} ~, \quad 
        - \pdv{p}{N} \Big \vert_{V,T} = \pdv{\mu}{V} \Big \vert_{N, T} ~. 
    \end{equation}
    \begin{proof}
        By means of the exterior derivative, we have 
        \begin{equation*}
        \begin{aligned}
            d (dF) & = - d (S dT) - d (p dV) + d (\mu dN) \\ & = - \pdv{S}{T} \underbrace{dT \wedge dT}_0 - \pdv{S}{V} dV \wedge dT - \pdv{S}{N} dN \wedge dT - \pdv{p}{T} dT \wedge dV - \pdv{p}{V} \underbrace{dV \wedge dV}_0 \\ & \quad - \pdv{p}{N} dN \wedge dV + \pdv{\mu}{T} dT \wedge dN + \pdv{\mu}{V} dV \wedge dN + \pdv{\mu}{N} \underbrace{dN \wedge dN}_0 \\ & = - \pdv{S}{V} dV \wedge dT - \pdv{S}{N} dN \wedge dT - \pdv{p}{T} dT \wedge dV \\ & \quad - \pdv{p}{N} dN \wedge dV + \pdv{\mu}{T} dT \wedge dN + \pdv{\mu}{V} dV \wedge dN ~.
        \end{aligned}
        \end{equation*}
        At constant $N$, we obtain 
        \begin{equation*}
        \begin{aligned}
            0 & = d^2 F = - \pdv{S}{V} dV \wedge dT - \pdv{S}{N} \underbrace{dN}_0 \wedge dT - \pdv{p}{T} dT \wedge dV \\ & \quad - \pdv{p}{N} \underbrace{dN}_0 \wedge dV + \pdv{\mu}{T} dT \wedge \underbrace{dN}_0 + \pdv{\mu}{V} dV \wedge \underbrace{dN}_0 \\ & = - \pdv{S}{V} dV \wedge dT - \pdv{p}{T} dT \wedge dV = - \pdv{S}{V} dV \wedge dT + \pdv{p}{T} dV \wedge dT  ~,
        \end{aligned}
        \end{equation*}
        hence, by the linear independence of $V$ and $T$, we find
        \begin{equation*}
            \pdv{S}{V} \Big \vert_{T,N} = \pdv{p}{T} \Big \vert_{V,N} ~.
        \end{equation*}
        At constant $V$, we obtain
        \begin{equation*}
        \begin{aligned}
            0 & = d^2 F = - \pdv{S}{V} \underbrace{dV}_0 \wedge dT - \pdv{S}{N} dN \wedge dT - \pdv{p}{T} dT \wedge \underbrace{dV}_0 \\ & \quad - \pdv{p}{N} dN \wedge \underbrace{dV}_0 + \pdv{\mu}{T} dT \wedge dN + \pdv{\mu}{V} \underbrace{dV}_0 \wedge dN \\ & = - \pdv{S}{N} dN \wedge dT + \pdv{\mu}{T} dT \wedge dN = - \pdv{S}{N} dN \wedge dT - \pdv{\mu}{T} dN \wedge dT~,
        \end{aligned}
        \end{equation*}
        hence, by the linear independence of $N$ and $T$, we find
        \begin{equation*}
            - \pdv{S}{N} \Big \vert_{T,V} = \pdv{\mu}{T} \Big \vert_{N, V} ~.
        \end{equation*}
        At constant $T$, we obtain
        \begin{equation*}
        \begin{aligned}
            0 & = d^2 F = - \pdv{S}{V} dV \wedge \underbrace{dT}_0 - \pdv{S}{N} dN \wedge \underbrace{dT}_0 - \pdv{p}{T} \underbrace{dT}_0 \wedge dV \\ & \quad - \pdv{p}{N} dN \wedge dV + \pdv{\mu}{T} \underbrace{dT}_0 \wedge dN + \pdv{\mu}{V} dV \wedge dN \\ & = - \pdv{p}{N} dN \wedge dV + \pdv{\mu}{V} dV \wedge dN =- \pdv{p}{N} dN \wedge dV - \pdv{\mu}{V} dN \wedge dV ~,
        \end{aligned}
        \end{equation*}
        hence, by the linear independence of $N$ and $V$, we find
        \begin{equation*}
            - \pdv{p}{N} \Big \vert_{V,T} = \pdv{\mu}{V} \Big \vert_{N, T} ~.
        \end{equation*}
    \end{proof}

\section{Enthalpy} 

    The enthalpy is defined as 
    \begin{equation*}
        H = E + pV ~.
    \end{equation*}
    Its differential is 
    \begin{equation}\label{td:d:h}
        dH \leq TdS + Vdp + \mu dN ~.
    \end{equation}
    Its associated chart is
    \begin{equation*}
        H = H(p, S, N) ~.
    \end{equation*}
    \begin{proof}
        By a Legendre transform, which means to complete a differential, we obtain
        \begin{equation*}
            dE \leq T dS - p dV + \mu dN = TdS - d(pV) + V dp + \mu dN ~,
        \end{equation*}
        hence,
        \begin{equation*}
            dH = d(E + pV) \leq TdS + Vdp + \mu dN ~.
        \end{equation*}
    \end{proof}
    The equations of state are
    \begin{equation}\label{td:es:h}
        T = \pdv{H}{S} \Big \vert_{p,N} ~, \quad V = - \pdv{H}{p} \Big \vert_{S,N} ~, \quad \mu = \pdv{H}{N} \Big \vert_{S, p} ~. 
    \end{equation}
    \begin{proof}
        At constant $p$ and $N$, we have
        \begin{equation*}
            dH = TdS + V\underbrace{dp}_0 + \mu \underbrace{dN}_0 ~,
        \end{equation*}
        hence,
        \begin{equation*}
            T = \pdv{H}{S} \Big \vert_{p,N} ~.
        \end{equation*}
        At constant $S$ and $N$, we have
        \begin{equation*}
            dH = T\underbrace{dS}_0 + Vdp + \mu \underbrace{dN}_0~,
        \end{equation*}
        hence,
        \begin{equation*}
            V = - \pdv{H}{p} \Big \vert_{S,N} ~.
        \end{equation*}
        At constant $S$ and $p$, we have
        \begin{equation*}
            dH = T\underbrace{dS}_0 + V\underbrace{dp}_0 + \mu dN ~,
        \end{equation*}
        hence,
        \begin{equation*}
            \mu = \pdv{H}{N} \Big \vert_{S, p} ~.
        \end{equation*}
    \end{proof}
    The integrability conditions are 
    \begin{equation}\label{td:int:h}
        \pdv{V}{S} \Big \vert_{p,N} = \pdv{T}{p} \Big \vert_{S,N} ~, \quad 
        \pdv{V}{N} \Big \vert_{p,S} = \pdv{\mu}{p} \Big \vert_{N, S} ~, \quad 
        \pdv{\mu}{S} \Big \vert_{N,p} = \pdv{T}{N} \Big \vert_{S, p} ~. 
    \end{equation}
    \begin{proof}
        By means of the exterior derivative, we have 
        \begin{equation*}
        \begin{aligned}
            d (dH) & = d (T dS) + d (V dp) + d (\mu dN) \\ & = \pdv{T}{S} \underbrace{dS \wedge dS}_0 + \pdv{T}{p} dp \wedge dS + \pdv{T}{N} dN \wedge dS + \pdv{V}{S} dS \wedge dp + \pdv{V}{p} \underbrace{dp \wedge dp}_0 \\ & \quad + \pdv{V}{N} dN \wedge dp + \pdv{\mu}{S} dS \wedge dN + \pdv{\mu}{p} dp \wedge dN + \pdv{\mu}{N} \underbrace{dN \wedge dN}_0 \\ & = \pdv{T}{p} dp \wedge dS + \pdv{T}{N} dN \wedge dS + \pdv{V}{S} dS \wedge dp \\ & \quad + \pdv{V}{N} dN \wedge dp + \pdv{\mu}{S} dS \wedge dN + \pdv{\mu}{p} dp \wedge dN  ~.
        \end{aligned}
        \end{equation*}
        At constant $N$, we obtain
        \begin{equation*}
        \begin{aligned}
            0 & = d^2 H = \pdv{T}{p} dp \wedge dS + \pdv{T}{N} \underbrace{dN}_0 \wedge dS + \pdv{V}{S} dS \wedge dp \\ & \quad + \pdv{V}{N} \underbrace{dN}_0 \wedge dp + \pdv{\mu}{S} dS \wedge \underbrace{dN}_0 + \pdv{\mu}{p} dp \wedge \underbrace{dN}_0 \\ & = \pdv{T}{p} dp \wedge dS + \pdv{V}{S} dS \wedge dp = \pdv{T}{p} dp \wedge dS - \pdv{V}{S} dS \wedge dp ~,
        \end{aligned}
        \end{equation*}
        hence, by the linear independence of $S$ and $p$, we find
        \begin{equation*}
            \pdv{V}{S} \Big \vert_{p,N} = \pdv{T}{p} \Big \vert_{S,N} ~.
        \end{equation*}
        At constant $S$, we obtain
        \begin{equation*}
        \begin{aligned}
            0 & = d^2 H = \pdv{T}{p} dp \wedge \underbrace{dS}_0 + \pdv{T}{N} dN \wedge \underbrace{dS}_0 + \pdv{V}{S} \underbrace{dS}_0 \wedge dp \\ & \quad + \pdv{V}{N} dN \wedge dp + \pdv{\mu}{S} \underbrace{dS}_0 \wedge dN + \pdv{\mu}{p} dp \wedge dN \\ & = \pdv{V}{N} dN \wedge dp + \pdv{\mu}{p} dp \wedge dN = \pdv{V}{N} dN \wedge dp - \pdv{\mu}{p} dN \wedge dp ~,
        \end{aligned}
        \end{equation*}
        hence, by the linear independence of $N$ and $p$, we find
        \begin{equation*}
            \pdv{V}{N} \Big \vert_{p,S} = \pdv{\mu}{p} \Big \vert_{N, S} ~.
        \end{equation*}
        At constant $p$, we obtain
        \begin{equation*}
        \begin{aligned}
            0 & = d^2 H = \pdv{T}{p} \underbrace{dp}_0 \wedge dS + \pdv{T}{N} dN \wedge dS + \pdv{V}{S} dS \wedge \underbrace{dp}_0 \\ & \quad + \pdv{V}{N} dN \wedge \underbrace{dp}_0 + \pdv{\mu}{S} dS \wedge dN + \pdv{\mu}{p} \underbrace{dp}_0 \wedge dN \\ & = \pdv{T}{N} dN \wedge dS + \pdv{\mu}{S} dS \wedge dN = \pdv{T}{N} dN \wedge dS - \pdv{\mu}{S} dS \wedge dN ~,
        \end{aligned}
        \end{equation*}
        hence, by the linear independence of $S$ and $N$, we find
        \begin{equation*}
            \pdv{\mu}{S} \Big \vert_{N,p} = \pdv{T}{N} \Big \vert_{S, p} ~.
        \end{equation*}
    \end{proof}

\section{Gibbs free energy} 

    The Gibbs free energy is defined as 
    \begin{equation*}
        G = E - TS + pV = F + pV = H - TS ~.
    \end{equation*}
    Its differential is 
    \begin{equation} \label{td:d:g}
        dG \leq - SdT + Vdp + \mu dN ~.
    \end{equation}
    Its associated chart is
    \begin{equation*}
        G = G(p, T, N) ~.
    \end{equation*}
    \begin{proof}
        By a Legendre transform, which means to complete a differential, we obtain
        \begin{equation*}
            dE \leq T dS - p dV + \mu dN = d(TS) - S dT - d(pV) + V dp + \mu dN ~,
        \end{equation*}
        hence 
        \begin{equation*}
            dG = d(E - TS + pV) \leq - S dT + Vdp + \mu dN ~.
        \end{equation*}
    \end{proof}
    The equations of state are
    \begin{equation}\label{td:es:g}
        S = - \pdv{G}{T} \Big \vert_{p,N} ~, \quad V = \pdv{G}{p} \Big \vert_{T,N} ~, \quad \mu = \pdv{G}{N} \Big \vert_{p,T} ~. 
    \end{equation}
    \begin{proof}
        At constant $p$ and $N$, we have
        \begin{equation*}
            dG = - S dT + V\underbrace{dp }_0 + \mu \underbrace{dN}_0  ~,
        \end{equation*}
        hence,
        \begin{equation*}
            S = - \pdv{G}{T} \Big \vert_{p,N}  ~.
        \end{equation*}
        At constant $T$ and $N$, we have
        \begin{equation*}
            dG = - S \underbrace{dT}_0  + Vdp + \mu \underbrace{dN}_0  ~,
        \end{equation*}
        hence,
        \begin{equation*}
            V = \pdv{G}{p} \Big \vert_{T,N} ~.
        \end{equation*}
        At constant $p$ and $T$, we have
        \begin{equation*}
            dG = - S \underbrace{dT}_0  + V\underbrace{dp}_0  + \mu dN ~,
        \end{equation*}
        hence,
        \begin{equation*}
            \mu = \pdv{G}{N} \Big \vert_{p,T} ~.
        \end{equation*}
    \end{proof}
    The integrability conditions are 
    \begin{equation}\label{td:int:g}
        - \pdv{V}{T} \Big \vert_{p,N} = \pdv{S}{p} \Big \vert_{T,N} ~, \quad 
        \pdv{V}{N} \Big \vert_{p,T} = \pdv{\mu}{p} \Big \vert_{N, T} ~, \quad 
        - \pdv{S}{N} \Big \vert_{T,p} = \pdv{\mu}{T} \Big \vert_{N, p} ~. 
    \end{equation}
    \begin{proof}
        By means of the exterior derivative, we have 
        \begin{equation*}
        \begin{aligned}
            d (dG) & = - d (S dT) + d (V dp) + d (\mu dN) \\ & = - \pdv{S}{T} \underbrace{dT \wedge dT}_0 - \pdv{S}{p} dp \wedge dT - \pdv{S}{N} dN \wedge dT + \pdv{V}{T} dT \wedge dp + \pdv{V}{p} \underbrace{dp \wedge dp}_0 \\ & \quad + \pdv{V}{N} dN \wedge dp + \pdv{\mu}{T} dT \wedge dN + \pdv{\mu}{p} dp \wedge dN + \pdv{\mu}{N} \underbrace{dN \wedge dN}_0 \\ & = - \pdv{S}{p} dp \wedge dT - \pdv{S}{N} dN \wedge dT + \pdv{V}{T} dT \wedge dp \\ & \quad + \pdv{V}{N} dN \wedge dp + \pdv{\mu}{T} dT \wedge dN + \pdv{\mu}{p} dp \wedge dN ~.
        \end{aligned}
        \end{equation*}
        At constant $N$, we obtain
        \begin{equation*}
        \begin{aligned}
            0 & = d^2 G = - \pdv{S}{p} dp \wedge dT - \pdv{S}{N} \underbrace{dN}_0 \wedge dT + \pdv{V}{T} dT \wedge dp \\ & \quad + \pdv{V}{N} \underbrace{dN}_0 \wedge dp + \pdv{\mu}{T} dT \wedge \underbrace{dN}_0 + \pdv{\mu}{p} dp \wedge \underbrace{dN}_0 \\ & = - \pdv{S}{p} dp \wedge dT + \pdv{V}{T} dT \wedge dp = - \pdv{S}{p} dp \wedge dT - \pdv{V}{T} dp \wedge dT ~,
        \end{aligned}
        \end{equation*}
        hence, by the linear independence of $p$ and $T$, we find
        \begin{equation*}
            - \pdv{V}{T} \Big \vert_{p,N} = \pdv{S}{p} \Big \vert_{T,N} ~.
        \end{equation*}
        At constant $T$, we obtain
        \begin{equation*}
        \begin{aligned}
            0 & = d^2 G = - \pdv{S}{p} dp \wedge \underbrace{dT}_0 - \pdv{S}{N} dN \wedge \underbrace{dT}_0 + \pdv{V}{T} \underbrace{dT}_0 \wedge dp \\ & \quad + \pdv{V}{N} dN \wedge dp + \pdv{\mu}{T} \underbrace{dT}_0 \wedge dN + \pdv{\mu}{p} dp \wedge dN \\ & = \pdv{V}{N} dN \wedge dp + \pdv{\mu}{p} dp \wedge dN = \pdv{V}{N} dN \wedge dp - \pdv{\mu}{p} dp \wedge dN ~,
        \end{aligned}
        \end{equation*}
        hence, by the linear independence of $p$ and $N$, we find
        \begin{equation*}
            \pdv{V}{N} \Big \vert_{p,T} = \pdv{\mu}{p} \Big \vert_{N, T} ~.
        \end{equation*}
        At constant $p$, we obtain
        \begin{equation*}
        \begin{aligned}
            0 & = d^2 G = - \pdv{S}{p} \underbrace{dp}_0 \wedge dT - \pdv{S}{N} dN \wedge dT + \pdv{V}{T} dT \wedge \underbrace{dp}_0 \\ & \quad + \pdv{V}{N} dN \wedge \underbrace{dp}_0 + \pdv{\mu}{T} dT \wedge dN + \pdv{\mu}{p} \underbrace{dp}_0 \wedge dN \\ & = - \pdv{S}{N} dN \wedge dT + \pdv{\mu}{T} dT \wedge dN = - \pdv{S}{N} dN \wedge dT - \pdv{\mu}{T} dN \wedge dT ~,
        \end{aligned}
        \end{equation*}
        hence, by the linear independence of $N$ and $T$, we find
        \begin{equation*}
            - \pdv{S}{N} \Big \vert_{T,p} = \pdv{\mu}{T} \Big \vert_{N, p} ~.
        \end{equation*}
    \end{proof}

\section{Grand potential} 

    The grand potential is defined as 
    \begin{equation}\label{td:o}
        \Omega = E - TS - \mu N = F - \mu N ~.
    \end{equation}
    Its differential is 
    \begin{equation}\label{td:d:o}
        d\Omega \leq - SdT - pdV - N d\mu ~.
    \end{equation}
    Its associated chart is
    \begin{equation}\label{td:coord:o}
        \Omega = \Omega(T, V, \mu) ~.
    \end{equation}
    \begin{proof}
        By a Legendre transform, which means to complete a differential, we obtain
        \begin{equation*}
            dE \leq T dS - p dV + \mu dN = d(TS) - SdT - p dV + (\mu N) - N d\mu ~,
        \end{equation*}
        hence,
        \begin{equation*}
            d\Omega = d(E - TS - \mu N) \leq - SdT - p dV - N d\mu ~.
        \end{equation*}
    \end{proof}
    The equations of state are
    \begin{equation}\label{td:es:o}
        S = - \pdv{\Omega}{T} \Big \vert_{\mu,V} ~, \quad p = - \pdv{\Omega}{V} \Big \vert_{T,\mu} ~, \quad \mu = - \pdv{\Omega}{N} \Big \vert_{T,V} ~. 
    \end{equation}
    \begin{proof}
        At constant $\mu$ and $V$, we have
        \begin{equation*}
            d\Omega = - SdT - p\underbrace{dV}_0 - N \underbrace{d\mu}_0 = - S dT ~,
        \end{equation*}
        hence,
        \begin{equation*}
            S = - \pdv{\Omega}{T} \Big \vert_{\mu,V} ~.
        \end{equation*}
        At constant $T$ and $\mu$, we have
        \begin{equation*}
            d\Omega = - S \underbrace{dT}_0 - pdV - N \underbrace{d\mu}_ 0 = - p dV ~,
        \end{equation*}
        hence,
        \begin{equation*}
            p = - \pdv{\Omega}{V} \Big \vert_{T,\mu} ~.
        \end{equation*}
        At constant $T$ and $V$, we have
        \begin{equation*}
            d\Omega = - S\underbrace{dT}_0 - p\underbrace{dV}_0 - N d\mu = - N d\mu~,
        \end{equation*}
        hence 
        \begin{equation*}
            \mu = - \pdv{\Omega}{N} \Big \vert_{T,V} ~.
        \end{equation*}
    \end{proof}
    The integrability conditions are 
    \begin{equation}\label{td:int:o}
        \pdv{S}{\mu} \Big \vert_{T,V} = \pdv{N}{T} \Big \vert_{\mu,V} ~, \quad 
        \pdv{S}{V} \Big \vert_{T,\mu} = \pdv{p}{T} \Big \vert_{V, \mu} ~, \quad 
        \pdv{p}{\mu} \Big \vert_{V,T} = \pdv{N}{V} \Big \vert_{\mu, T} ~. 
    \end{equation}
    \begin{proof}
        By means of the exterior derivative, we have 
        \begin{equation*}
        \begin{aligned}
            d (d\Omega) & = - d (S dT) - d (p dV) - d (N d\mu) \\ & = - \pdv{S}{T} \underbrace{dT \wedge dT}_0 - \pdv{S}{V} dV \wedge dT - \pdv{S}{\mu} d\mu \wedge dT - \pdv{p}{T} dT \wedge dV - \pdv{p}{V} \underbrace{dV \wedge dV}_0 \\ & \quad - \pdv{p}{\mu} d\mu \wedge dV - \pdv{N}{T} dT \wedge d\mu - \pdv{N}{V} dV \wedge d\mu - \pdv{N}{\mu} \underbrace{d\mu \wedge d\mu}_0 \\ & = - \pdv{S}{V} dV \wedge dT - \pdv{S}{\mu} d\mu \wedge dT - \pdv{p}{T} dT \wedge dV \\ & \quad - \pdv{p}{\mu} d\mu \wedge dV - \pdv{N}{T} dT \wedge d\mu - \pdv{N}{V} dV \wedge d\mu ~.
        \end{aligned}
        \end{equation*}
        At constant $\mu$, we obtain
        \begin{equation*}
        \begin{aligned}
            0 & = d^2 \Omega = - \pdv{S}{V} dV \wedge dT - \pdv{S}{\mu} \underbrace{d\mu}_0 \wedge dT - \pdv{p}{T} dT \wedge dV \\ & \quad - \pdv{p}{\mu} \underbrace{d\mu}_0 \wedge dV - \pdv{N}{T} dT \wedge \underbrace{d\mu}_0 - \pdv{N}{V} dV \wedge \underbrace{d\mu}_0 \\ & = - \pdv{S}{V} dV \wedge dT - \pdv{p}{T} dT \wedge dV = - \pdv{S}{V} dV \wedge dT + \pdv{p}{T} dV \wedge dT ~,
        \end{aligned}
        \end{equation*}
        hence, by the linear independence of $V$ and $T$, we find
        \begin{equation*}
            \pdv{S}{V} \Big \vert_{T,\mu} = \pdv{p}{T} \Big \vert_{V, \mu} ~.
        \end{equation*}
        At constant $V$, we obtain
        \begin{equation*}
        \begin{aligned}
            0 & = d^2 \Omega = - \pdv{S}{V} \underbrace{dV}_0 \wedge dT - \pdv{S}{\mu} d\mu \wedge dT - \pdv{p}{T} dT \wedge \underbrace{dV}_0 \\ & \quad - \pdv{p}{\mu} d\mu \wedge \underbrace{dV}_0 - \pdv{N}{T} dT \wedge d\mu - \pdv{N}{V} \underbrace{dV}_0 \wedge d\mu \\ & = - \pdv{S}{\mu} d\mu \wedge dT - \pdv{N}{T} dT \wedge d\mu = - \pdv{S}{\mu} d\mu \wedge dT + \pdv{N}{T} d\mu \wedge dT ~,
        \end{aligned}
        \end{equation*}
        hence, by the linear independence of $\mu$ and $T$, we find
        \begin{equation*}
            \pdv{S}{\mu} \Big \vert_{T,V} = \pdv{N}{T} \Big \vert_{\mu,V} ~.
        \end{equation*}
        At constant $T$, we obtain
        \begin{equation*}
        \begin{aligned}
            0 & = d^2 \Omega = - \pdv{S}{V} dV \wedge \underbrace{dT}_0 - \pdv{S}{\mu} d\mu \wedge \underbrace{dT}_0 - \pdv{p}{T} \underbrace{dT}_0 \wedge dV \\ & \quad - \pdv{p}{\mu} d\mu \wedge dV - \pdv{N}{T} \underbrace{dT}_0 \wedge d\mu - \pdv{N}{V} dV \wedge d\mu \\ & = - \pdv{p}{\mu} d\mu \wedge dV - \pdv{N}{V} dV \wedge d\mu=  - \pdv{p}{\mu} d\mu \wedge dV + \pdv{N}{V} d\mu \wedge dV ~,
        \end{aligned}
        \end{equation*}
        hence, by the linear independence of $N$ and $V$, we find
        \begin{equation*}
            \pdv{p}{\mu} \Big \vert_{V,T} = \pdv{N}{V} \Big \vert_{\mu, T} ~.
        \end{equation*}
    \end{proof}

    A few comments can be made about these potentials. Notice that  they are not homogeneous functions since they depend on mixed extensive and intensive variables. However, they are extensive, i.e. 
    \begin{equation}\label{a6}
        F = N f(T, v) ~, \quad H = N h(p, s) ~, \quad G = N g(T, p) ~, \quad \Omega = N f \omega (T, \mu) ~,
    \end{equation}
    where $f$ is the specific Helmholtz free energy, $h$ is the specific enthalpy, $g$ is the specific Gibbs free energy and $\omega$ is the specific grand potential. Furthermore, observe that the chemical potential is also the Gibbs free energy per particle
    \begin{equation}
        g(T, p) = \mu(T, p) ~.
    \end{equation}
    \begin{proof}
        In fact, using~\eqref{td:es:g} and~\eqref{a6}
        \begin{equation*}
            \mu = \pdv{G}{N} = \pdv{}{N}(Ng) = g ~.
        \end{equation*}
    \end{proof}
    Finally, notice that 
    \begin{equation}\label{td:o2}
        \Omega = - pV ~.
    \end{equation}
    \begin{proof}
        Using~\eqref{td:e} and~\eqref{td:o}
        \begin{equation*}
            \Omega = E - TS - \mu N = \cancel{TS} - pV + \cancel{\mu N} - \cancel{TS} - \cancel{\mu N} = - pV ~.
        \end{equation*}
    \end{proof}

\section{Summary}

    A summary of all charts and differentials is given by 
    \begin{equation*}
        E(S, V, N) ~, \quad dE = TdS - p dV + \mu dN ~,
    \end{equation*}
    \begin{equation*}
        S(E, V, N) ~, \quad dS = dE/T + p dV/T - \mu dN/T ~,
    \end{equation*}
    \begin{equation*}
        F(T, V, N) ~, \quad dF = - S dT - p dV + \mu dN ~,
    \end{equation*}
    \begin{equation*}
        H(S, p, N) ~, \quad dH = TdS + V dp + \mu dN ~,
    \end{equation*}
    \begin{equation*}
        G(T, p, N) ~, \quad d G = - SdT + V dp + \mu dN ~,
    \end{equation*}
    \begin{equation*}
        \Omega(T, V, \mu) ~, \quad d\Omega = TdS - p dV + \mu dN ~.
    \end{equation*}

    A summary of all the equations of state is given by 
    \begin{equation*}
        T = \pdv{E}{S} \Big \vert_{V,N} ~, \quad p = - \pdv{E}{V} \Big \vert_{S,N} ~, \quad \mu = \pdv{E}{N} \Big \vert_{S,V} ~,
    \end{equation*}
    \begin{equation*}
        \frac{1}{T} = \pdv{S}{E} \Big \vert_{V, N} ~, \quad \frac{p}{T} = \pdv{S}{V} \Big \vert_{E, N} ~, \quad - \frac{\mu}{T} = \pdv{S}{N} \Big \vert_{E, V} ~,
    \end{equation*}
    \begin{equation*}
        S = - \pdv{F}{T} \Big \vert_{V,N} ~, \quad p = - \pdv{F}{V} \Big \vert_{T,N} ~, \quad \mu = \pdv{F}{N} \Big \vert_{T,V} ~,
    \end{equation*}
    \begin{equation*}
        T = \pdv{H}{S} \Big \vert_{p,N} ~, \quad V = - \pdv{H}{p} \Big \vert_{S,N} ~, \quad \mu = \pdv{H}{N} \Big \vert_{S, p} ~,
    \end{equation*}
    \begin{equation*}
        S = - \pdv{G}{T} \Big \vert_{p,N} ~, \quad V = \pdv{G}{p} \Big \vert_{T,N} ~, \quad \mu = \pdv{G}{N} \Big \vert_{p,T} ~,
    \end{equation*}
    \begin{equation*}
        S = - \pdv{\Omega}{T} \Big \vert_{\mu,V} ~, \quad p = - \pdv{\Omega}{V} \Big \vert_{T,\mu} ~, \quad \mu = - \pdv{\Omega}{N} \Big \vert_{T,V} ~.
    \end{equation*}

    A summary of all integrability conditions is given by 
    \begin{equation*}
        - \pdv{T}{V} \Big \vert_{S,N} = \pdv{p}{S} \Big \vert_{V,N} ~, \quad 
        \pdv{T}{N} \Big \vert_{S,V} = \pdv{\mu}{S} \Big \vert_{N, V} ~, \quad 
        - \pdv{p}{N} \Big \vert_{V,S} = \pdv{\mu}{V} \Big \vert_{N, S} ~,
    \end{equation*}
    \begin{equation*}
        \pdv{S}{V} \Big \vert_{T,N} = \pdv{p}{T} \Big \vert_{V,N} ~, \quad 
        - \pdv{S}{N} \Big \vert_{T,V} = \pdv{\mu}{T} \Big \vert_{N, V} ~, \quad 
        - \pdv{p}{N} \Big \vert_{V,T} = \pdv{\mu}{V} \Big \vert_{N, T} ~,
    \end{equation*}
    \begin{equation*}
        \pdv{V}{S} \Big \vert_{p,N} = \pdv{T}{p} \Big \vert_{S,N} ~, \quad 
        \pdv{V}{N} \Big \vert_{p,S} = \pdv{\mu}{p} \Big \vert_{N, S} ~, \quad 
        \pdv{\mu}{S} \Big \vert_{N,p} = \pdv{T}{N} \Big \vert_{S, p} ~,
    \end{equation*}
    \begin{equation*}
        - \pdv{V}{T} \Big \vert_{p,N} = \pdv{S}{p} \Big \vert_{T,N} ~, \quad 
        \pdv{V}{N} \Big \vert_{p,T} = \pdv{\mu}{p} \Big \vert_{N, T} ~, \quad 
        - \pdv{S}{N} \Big \vert_{T,p} = \pdv{\mu}{T} \Big \vert_{N, p} ~,
    \end{equation*}
    \begin{equation*}
        \pdv{S}{\mu} \Big \vert_{T,V} = \pdv{N}{T} \Big \vert_{\mu,V} ~, \quad 
        \pdv{S}{V} \Big \vert_{T,\mu} = \pdv{p}{T} \Big \vert_{V, \mu} ~, \quad 
        \pdv{p}{\mu} \Big \vert_{V,T} = \pdv{N}{V} \Big \vert_{\mu, T} ~.
    \end{equation*}

\chapter{Stability conditions}

    In this chapter, we will rewrite integrability condition in terms of Jacobian determinant and we will study what are the stability conditions that a system must fulfill in order to be in equilibrium.

\section{Maxwell's relations}

    Integrability condition, called also Maxwell's relations, can be written as Jacobian determinant in the following way 
    \begin{equation*}
        \pdv{a}{b} \Big \vert_{c, d} = \pdv{(a, c, d)}{(b, c, d)} ~,
    \end{equation*}
    such that it satisfies the property 
    \begin{equation*}
        \pdv{(a, c, d)}{(b, c, d)} = - \pdv{(c, a, d)}{(b, c, d)} = -\pdv{(a, c, d)}{(c, b, d)} = \pdv{(a, d, c)}{(b, c, d)} = \pdv{(a, c, d)}{(b, d, c)} ~.
    \end{equation*}
    
    For the energy, they are 
    \begin{equation*}
        \pdv{(T, S, N)}{(p, V, N)} = 1 ~, \quad \pdv{(T, S, V)}{(N, \mu, V)} = 1 ~, \quad \pdv{(p, V, S)}{(\mu, N, S)} = 1 ~.
    \end{equation*}
    \begin{proof}
        Using the first of~\eqref{td:int:e}, we obtain
        \begin{equation*}
            - \pdv{T}{V} \Big \vert_{S, N} = \pdv{p}{S} \Big \vert_{V, N} \rightarrow \pdv{(T, S, N)}{(V, S, N)} = - \pdv{(p, V, N)}{(S, V, N)} = \pdv{(p, V, N)}{(V, S, N)} ~,
        \end{equation*} 
        hence, inverting the right-handed side, we find
        \begin{equation*}
            1 = \pdv{(T, S, N)}{(V, S, N)} \pdv{(p, V, N)}{(V, S, N)}^{-1} = \pdv{(T, S, N)}{(V, S, N)} \pdv{(V, S, N)}{(p, V, N)} = \pdv{(T, S, N)}{(p, V, N)} ~.
        \end{equation*} 
        Using the second of~\eqref{td:int:e}, we obtain
        \begin{equation*}
            \pdv{T}{N} \Big \vert_{S, V} = \pdv{\mu}{S} \Big \vert_{N, V} \rightarrow \pdv{(T, S, V)}{(N, S, V)} = \pdv{(\mu, N, V)}{(S, N, V)} = - \pdv{(\mu, N, V)}{(N, S, V)} = \pdv{(N, \mu, V)}{(N, S, V)} ~,
        \end{equation*} 
        hence, inverting the right-handed side, we find
        \begin{equation*}
            1 = \pdv{(T, S, V)}{(N, S, V)} \pdv{(N, \mu, V)}{(N, S, V)}^{-1} = \pdv{(T, S, V)}{(N, S, V)} \pdv{(N, S, V)}{(N, \mu, V)} = \pdv{(T, S, V)}{(N, \mu, V)} ~.
        \end{equation*} 
        Using the third of~\eqref{td:int:e}, we obtain
        \begin{equation*}
            - \pdv{p}{N} \Big \vert_{V, S} = \pdv{\mu}{V} \Big \vert_{N, S} \rightarrow \pdv{(p, V, S)}{(N, V, S)} = - \pdv{(\mu, N, S)}{(V, N ,S)} = \pdv{(\mu, N, S)}{(N, V ,S)} ~,
        \end{equation*} 
        hence, inverting the right-handed side, we find
        \begin{equation*}
            1 = \pdv{(p, V, S)}{(N, V, S)} \pdv{(\mu, N, S)}{(N, V ,S)}^{-1} = \pdv{(p, V, S)}{(N, V, S)} \pdv{(N, V ,S)}{(\mu, N, S)} = \pdv{(p, V, S)}{(\mu, N, S)} ~.
        \end{equation*} 
    \end{proof}
    For the Helmholtz free energy, they are 
    \begin{equation*}
        \pdv{(S, T, N)}{(V, p, N)} = 1 ~, \quad \pdv{(S, T, V)}{(\mu, N, V)} = 1 ~, \quad \pdv{(p, V, T)}{(\mu, N, T)} = 1 ~.
    \end{equation*}
    \begin{proof}
        Using the first of~\eqref{td:int:f}, we obtain
        \begin{equation*}
            \pdv{S}{V} \Big \vert_{T, N} = \pdv{p}{T} \Big \vert_{V, N} \rightarrow \pdv{(S, T, N)}{(V, T, N)} = \pdv{(p, V, N)}{(T, V, N)} = - \pdv{(p, V, N)}{(V, T, N)} = \pdv{(V, p, N)}{(V, T, N)} ~,
        \end{equation*} 
        hence, inverting the right-handed side, we find
        \begin{equation*}
            1 = \pdv{(S, T, N)}{(V, T, N)} \pdv{(V, p, N)}{(V, T, N)}^{-1} = \pdv{(S, T, N)}{(V, T, N)} \pdv{(V, T, N)}{(V, p, N)} = \pdv{(S, T, N)}{(V, p, N)} ~.
        \end{equation*} 
        Using the second of~\eqref{td:int:f}, we obtain
        \begin{equation*}
            - \pdv{S}{N} \Big \vert_{T, V} = \pdv{\mu}{T} \Big \vert_{N, V} \rightarrow \pdv{(S, T, V)}{(N, T, V)} = - \pdv{(\mu, N, V)}{(T, N, V)} = \pdv{(\mu, N, V)}{(N, T, V)} ~,
        \end{equation*} 
        hence, inverting the right-handed side, we find
        \begin{equation*}
            1 = \pdv{(S, T, V)}{(N, T, V)}  \pdv{(\mu, N, V)}{(N, T, V)}^{-1} = \pdv{(S, T, V)}{(N, T, V)} \pdv{(N, T, V)}{(\mu, N, V)} = \pdv{(S, T, V)}{(\mu, N, V)} ~.
        \end{equation*} 
        Using the third of~\eqref{td:int:f}, we obtain
        \begin{equation*}
            - \pdv{p}{N} \Big \vert_{V, T} = \pdv{\mu}{V} \Big \vert_{N, T} \rightarrow \pdv{(p, V, T)}{(N, V, T)} = - \pdv{(\mu, N, T)}{(V, N ,T)} = \pdv{(\mu, N, T)}{(N, V ,T)} ~,
        \end{equation*} 
        hence, inverting the right-handed side, we find
        \begin{equation*}
            1 = \pdv{(p, V, T)}{(N, V, T)} \pdv{(\mu, N, T)}{(N, V ,T)}^{-1} = \pdv{(p, V, T)}{(N, V, T)} \pdv{(N, V ,T)}{(\mu, N, T)} = \pdv{(p, V, T)}{(\mu, N, T)} ~.
        \end{equation*} 
    \end{proof}
    For the enthalpy, they are 
    \begin{equation*}
        \pdv{(V, p, N)}{(S, T, N)} = 1 ~, \quad \pdv{(V, p, S)}{(N, \mu, S)} = 1 ~, \quad \pdv{(\mu, N, p)}{(S, T, p)} = 1 ~.
    \end{equation*}
    \begin{proof}
        Using the first of~\eqref{td:int:h}, we obtain
        \begin{equation*}
            \pdv{V}{S} \Big \vert_{p, N} = \pdv{T}{p} \Big \vert_{S, N} \rightarrow \pdv{(V, p, N)}{(S, p, N)} = \pdv{(T, S, N)}{(p, S, N)} = - \pdv{(T, S, N)}{(S, p, N)} = \pdv{(S, T, N)}{(S, p, N)} ~,
        \end{equation*} 
        hence, inverting the right-handed side, we find
        \begin{equation*}
            1 = \pdv{(V, p, N)}{(S, p, N)} \pdv{(S, T, N)}{(S, p, N)}^{-1} = \pdv{(V, p, N)}{(S, p, N)} \pdv{(S, p, N)}{(S, T, N)} = \pdv{(V, p, N)}{(S, T, N)} ~.
        \end{equation*} 
        Using the second of~\eqref{td:int:h}, we obtain
        \begin{equation*}
            \pdv{V}{N} \Big \vert_{p, S} = \pdv{\mu}{p} \Big \vert_{N, S} \rightarrow \pdv{(V, p, S)}{(N, p, S)} = \pdv{(\mu, N, S)}{(p, N, S)} = - \pdv{(\mu, N, S)}{(N, p, S)} = \pdv{(N, \mu, S)}{(N, p, S)} ~,
        \end{equation*} 
        hence, inverting the right-handed side, we find
        \begin{equation*}
            1 = \pdv{(V, p, S)}{(N, p, S)} \pdv{(N, \mu, S)}{(N, p, S)}^{-1} = \pdv{(V, p, S)}{(N, p, S)} \pdv{(N, p, S)}{(N, \mu, S)} = \pdv{(V, p, S)}{(N, \mu, S)} ~.
        \end{equation*} 
        Using the third of~\eqref{td:int:h}, we obtain
        \begin{equation*}
            \pdv{\mu}{S} \Big \vert_{N, p} = \pdv{T}{N} \Big \vert_{S, p} \rightarrow \pdv{(\mu, N, p)}{(S, N, p)} = \pdv{(T, S, p)}{(N, S, p)} = - \pdv{(T, S, p)}{(S, N,p)} = \pdv{(S, T, p)}{(S, N, p)}~,
        \end{equation*} 
        hence, inverting the right-handed side, we find
        \begin{equation*}
            1 = \pdv{(\mu, N, p)}{(S, N, p)} \pdv{(S, T, p)}{(S, N, p)}^{-1} = \pdv{(\mu, N, p)}{(S, N, p)} \pdv{(S, N, p)}{(S, T, p)} = \pdv{(\mu, N, p)}{(S, T, p)} ~.
        \end{equation*} 
    \end{proof}
    For the Gibbs free energy, they are 
    \begin{equation*}
        \pdv{(V, p, N)}{(S, T, N)} = 1 ~, \quad \pdv{(V, p, T)}{(N, \mu, T)} = 1 ~, \quad \pdv{(S, T, p)}{(\mu, N, p)} = 1 ~.
    \end{equation*}
    \begin{proof}
        Using the first of~\eqref{td:int:g}, we obtain
        \begin{equation*}
            - \pdv{V}{T} \Big \vert_{p, N} = \pdv{S}{p} \Big \vert_{T, N} \rightarrow \pdv{(V, p, N)}{(T, p, N)} = - \pdv{(S, T, N)}{(p, T, N)} = \pdv{(S, T, N)}{(T, p, N)} ~,
        \end{equation*} 
        hence, inverting the right-handed side, we find
        \begin{equation*}
            1 = \pdv{(V, p, N)}{(T, p, N)} \pdv{(S, T, N)}{(T, p, N)}^{-1} = \pdv{(V, p, N)}{(T, p, N)} \pdv{(T, p, N)}{(S, T, N)} = \pdv{(V, p, N)}{(S, T, N)} ~.
        \end{equation*} 
        Using the second of~\eqref{td:int:g}, we obtain
        \begin{equation*}
            \pdv{V}{N} \Big \vert_{p, T} = \pdv{\mu}{p} \Big \vert_{N, T} \rightarrow \pdv{(V, p, T)}{(N, p, T)} = \pdv{(\mu, N, T)}{(p, N, T)} = - \pdv{(\mu, N, T)}{(N, p, T)} = \pdv{(N, \mu, T)}{(N, p, T)} ~,
        \end{equation*} 
        hence, inverting the right-handed side, we find
        \begin{equation*}
            1 = \pdv{(V, p, T)}{(N, p, T)} \pdv{(N, \mu, T)}{(N, p, T)}^{-1} = \pdv{(V, p, T)}{(N, p, T)} \pdv{(N, p, T)}{(N, \mu, T)} = \pdv{(V, p, T)}{(N, \mu, T)} ~.
        \end{equation*} 
        Using the third of~\eqref{td:int:g}, we obtain
        \begin{equation*}
            - \pdv{S}{N} \Big \vert_{T, p} = \pdv{\mu}{T} \Big \vert_{N, p} \rightarrow \pdv{(S, T, p)}{(N, T, p)} = - \pdv{(\mu, N, p)}{(T, N, p)} = \pdv{(\mu, N, p)}{(N, T, p)} ~,
        \end{equation*} 
        hence, inverting the right-handed side, we find
        \begin{equation*}
            1 = \pdv{(S, T, p)}{(N, T, p)} \pdv{(\mu, N, p)}{(N, T, p)}^{-1} = \pdv{(S, T, p)}{(N, T, p)} \pdv{(N, T, p)}{(\mu, N, p)} = \pdv{(S, T, p)}{(\mu, N, p)} ~.
        \end{equation*} 
    \end{proof}
    For the grand potential, they are 
    \begin{equation*}
        \pdv{(S, T, V)}{(\mu, N, V)} = 1 ~, \quad \pdv{(S, T, \mu)}{(V, p, \mu)} = 1 ~, \quad \pdv{(p, V, T)}{(\mu, N, T)} = 1 ~.
    \end{equation*}
    \begin{proof}
        Using the first of~\eqref{td:int:o}, we obtain
        \begin{equation*}
            \pdv{S}{\mu} \Big \vert_{T, V} = \pdv{N}{T} \Big \vert_{\mu, V} \rightarrow \pdv{(S, T, V)}{(\mu, T, V)} = \pdv{(N, \mu, V)}{(T, \mu, V)} = - \pdv{(N, \mu, V)}{(\mu, T, V)} = \pdv{(\mu, N, V)}{(\mu, T, V)} ~,
        \end{equation*} 
        hence, inverting the right-handed side, we find
        \begin{equation*}
            1 = \pdv{(S, T, V)}{(\mu, T, V)} \pdv{(\mu, N, V)}{(\mu, T, V)}^{-1} = \pdv{(S, T, V)}{(\mu, T, V)} \pdv{(\mu, T, V)}{(\mu, N, V)} = \pdv{(S, T, V)}{(\mu, N, V)} ~.
        \end{equation*} 
        Using the second of~\eqref{td:int:o}, we obtain
        \begin{equation*}
            \pdv{S}{V} \Big \vert_{T, \mu} = \pdv{p}{T} \Big \vert_{V, \mu} \rightarrow \pdv{(S, T, \mu)}{(V, T, \mu)} = \pdv{(p, V, \mu)}{(T, V, \mu)} = - \pdv{(p, V, \mu)}{(V, T, \mu)} = \pdv{(V, p, \mu)}{(V, T, \mu)} ~,
        \end{equation*} 
        hence, inverting the right-handed side, we find
        \begin{equation*}
            1 = \pdv{(S, T, \mu)}{(V, T, \mu)} \pdv{(V, p, \mu)}{(V, T, \mu)}^{-1} = \pdv{(S, T, \mu)}{(V, T, \mu)} \pdv{(V, T, \mu)}{(V, p, \mu)} = \pdv{(S, T, \mu)}{(V, p, \mu)} ~.
        \end{equation*} 
        Using the third of~\eqref{td:int:o}, we obtain
        \begin{equation*}
            \pdv{p}{\mu} \Big \vert_{V, T} = \pdv{N}{V} \Big \vert_{\mu, T} \rightarrow \pdv{(p, V, T)}{(\mu, V, T)} = \pdv{(N, \mu, T)}{(V, \mu, T)} = - \pdv{(N, \mu, T)}{(\mu, V, T)} = \pdv{(\mu, N, T)}{(\mu, V, T)} ~,
        \end{equation*} 
        hence, inverting the right-handed side, we find
        \begin{equation*}
            1 = \pdv{(p, V, T)}{(\mu, V, T)} \pdv{(\mu, N, T)}{(\mu, V, T)}^{-1} = \pdv{(p, V, T)}{(\mu, V, T)} \pdv{(\mu, V, T)}{(\mu, N, T)} = \pdv{(p, V, T)}{(\mu, N, T)} ~.
        \end{equation*} 
    \end{proof}

    A summary of all integrability conditions is given by 
    \begin{equation*}
        \pdv{(T, S, N)}{(p, V, N)} = 1 ~, \quad \pdv{(T, S, V)}{(N, \mu, V)} = 1 ~, \quad \pdv{(p, V, S)}{(\mu, N, S)} = 1 ~,
    \end{equation*}
    \begin{equation*}
        \pdv{(S, T, N)}{(V, p, N)} = 1 ~, \quad \pdv{(S, T, V)}{(\mu, N, V)} = 1 ~, \quad \pdv{(p, V, T)}{(\mu, N, T)} = 1 ~,
    \end{equation*}
    \begin{equation*}
        \pdv{(V, p, N)}{(S, T, N)} = 1 ~, \quad \pdv{(V, p, S)}{(N, \mu, S)} = 1 ~, \quad \pdv{(\mu, N, p)}{(S, T, p)} = 1 ~,
    \end{equation*}
    \begin{equation*}
        \pdv{(V, p, N)}{(S, T, N)} = 1 ~, \quad \pdv{(V, p, T)}{(N, \mu, T)} = 1 ~, \quad \pdv{(S, T, p)}{(\mu, N, p)} = 1 ~,
    \end{equation*}
    \begin{equation*}
        \pdv{(S, T, V)}{(\mu, N, V)} = 1 ~, \quad \pdv{(S, T, \mu)}{(V, p, \mu)} = 1 ~, \quad \pdv{(p, V, T)}{(\mu, N, T)} = 1 ~.
    \end{equation*}

    Notice that not all the Maxwell's relations are independent, but only $6$ of them are
    \begin{equation}\label{td:max}
    \begin{gathered}
        \pdv{(p, V, S)}{(\mu, N, S)} = 1 ~, \quad \pdv{(p, V, T)}{(\mu, N, T)} = 1 ~, \quad \pdv{(p, V, N)}{(T, S, N)} = 1 ~, \\ \pdv{(T, S, \mu)}{(p, V, \mu)} = 1 ~, \quad \pdv{(T, S, p)}{(N, \mu, p)} = 1 ~, \quad \pdv{(T, S, V)}{(N, \mu, V)} = 1 ~.
    \end{gathered}
    \end{equation}
    The geometrical interpretation is that coordinate transformations, which mean that we changed into a different chart of independent thermodynamic variables, preserve volumes. 

\section{Stability conditions}

    Every thermodynamic potential has a natural chart. In fact, the configuration of stable equilbrium can be obtained by a set of variational principle, which can be derived by fixing to constants the natural independent variables. This variations principle derive from the second law of thermodynamics, since all systems evolve spontaneously to maximise entropy. Therefore, minima of the thermodynamic potentials correspond to stable equilibrium under boundary condition which keep constant the natural variables
    \begin{equation*}
        (T, V, N) = \text{const} \rightarrow \delta F = 0 ~, \delta^2 F > 0 ~, 
    \end{equation*}
    \begin{equation*}
        (S, p, N) = \text{const} \rightarrow \delta H = 0 ~, \delta^2 H > 0 ~, 
    \end{equation*}
    \begin{equation*}
        (T, p, N) = \text{const} \rightarrow \delta G = 0 ~, \delta^2 G > 0 ~, 
    \end{equation*}
    \begin{equation*}
        (T, V, \mu) = \text{const} \rightarrow \delta \Omega = 0 ~, \delta^2 \Omega > 0 ~.
    \end{equation*}

    Equilibrium of two subsystems requires that $T$, $p$ and $\mu$ are equal.
    \begin{proof}
        Consider two subsystems $A$ and $B$ with extensive variables $(E_A, V_A, N_A)$ and $(E_B, V_B, N_B)$. Therefore $E = E_A + E_B$, $V = V_A + V_B$ and $N = N_A + N_B$. The whole system is at fixed boundary conditions $E, V, S = const$. The entropy is additive 
        \begin{equation*}
            S = S_A + S_B = S_A(E_A, V_A, N_A) - S_B(E - E_A, V-V_A, N-N_A) ~.
        \end{equation*}
        Computing its derivative and imposing it to zero, using~\eqref{td:es:s}
        \begin{equation*}
        \begin{aligned}
            0 = \delta S & = \pdv{S_A}{E_A} \delta E_A + \pdv{S_A}{E_A} \delta E_A + \pdv{S_A}{V_A} \delta V_A + \pdv{S_A}{N_A} \delta N_A \\ & \quad + \pdv{S_B}{E_B} \underbrace{\delta (E - E_A)}_{- \delta E_A} + \pdv{S_B}{V_B} \underbrace{\delta (V - V_A)}_{- \delta V_A} + \pdv{S_B}{N_B} \underbrace{\delta (N - N_A)}_{- \delta N_A} \\ & = \pdv{S_A}{E_A} \delta E_A + \pdv{S_A}{V_A} \delta V_A + \pdv{S_A}{N_A} \delta N_A - \pdv{S_B}{E_B} \delta E_A - \pdv{S_B}{V_B}  \delta V_A - \pdv{S_B}{N_B} \delta N_A  \\ & = \delta E_A \Big ( \underbrace{\pdv{S_A}{E_A}}_{\frac{1}{T_A}} - \underbrace{\pdv{S_B}{E_B}}_{\frac{1}{T_B}} \Big) + \delta V_A \Big ( \underbrace{\pdv{S_A}{V_A}}_{\frac{p_A}{T_A}} - \underbrace{\pdv{S_B}{E_B}}_{\frac{p_B}{T_B}} \Big) + \delta N_A \Big (\underbrace{\pdv{S_A}{N_A}}_{ - \frac{\mu_A}{T_A}} - \underbrace{\pdv{S_B}{N_B}}_{- \frac{\mu_B}{T_B}} \Big) \\ & = \delta E_A \Big ( \frac{1}{T_A} - \frac{1}{T_B} \Big) + \delta V_A \Big ( \frac{p_A}{T_A} - \frac{p_B}{T_B} \Big) + \delta N_A \Big (- \frac{\mu_A}{T_A} + \frac{\mu_B}{T_B} \Big) ~,
        \end{aligned}
        \end{equation*}
        hence, by arbitrarity of $\delta E_A$, $\delta V_A$ and $\delta N_A$,
        \begin{equation*}
            T_A = T_B ~, \quad p_A = p_B ~, \quad \mu_A = \mu_B ~.
        \end{equation*}
    \end{proof}

    At $T, p, N = const$, the stability condition is 
    \begin{equation}\label{td:stab}
    \begin{aligned}
        & E_{SS} = \pdv{T}{S} \Big \vert_V > 0 ~, \quad E_{VV} = - \pdv{p}{V} \Big \vert_S > 0 ~, \\ & E_{SS}E_{VV} - E^2_{SV} = - \pdv{T}{S} \Big \vert_V \pdv{p}{V} \Big \vert_S - \Big ( \pdv{p}{S} \Big \vert_V \Big )^2 = - \pdv{T}{S} \Big \vert_V \pdv{p}{V} \Big \vert_S - \Big ( \pdv{T}{V} \Big \vert_S \Big )^2 > 0 ~.
    \end{aligned}
    \end{equation}
    \begin{proof}
        We know that $E = E(S, V, N)$ by~\eqref{td:coord:e}. At constant $N$, its variation is 
        \begin{equation*}
        \begin{aligned}
            \delta E & = \underbrace{\pdv{E}{S} \Big \vert_V }_T \delta S + \underbrace{\pdv{E}{V} \Big \vert_S}_{-p} \delta V  \\ & \quad + \frac{1}{2} \Big ( \underbrace{\pdvdu{E}{S} \Big \vert_V}_{E_{SS}} \delta S^2 + 2 \underbrace{\pdvd{E}{S}{V}}_{E_{SV}} \delta S \delta V + \underbrace{\pdvdu{E}{V} \Big \vert_S }_{E_{VV}} \delta V^2 \Big) \\ & = T \delta S - p \delta V + \frac{1}{2} \Big ( E_{SS} \delta S^2 + 2 E_{SV} \delta S \delta V + E_{VV} \delta V^2 \Big) ~.
        \end{aligned}
        \end{equation*}
        Via the variation of the Gibbs free energy, the first derivative terms vanishes. In fact
        \begin{equation*}
        \begin{aligned}
            0 = \delta G &= \delta E - T \delta S + p \delta V \\ & = \cancel{T \delta S} - \cancel{p \delta V} + \frac{1}{2} \Big ( E_{SS} \delta S^2 + 2 E_{SV} \delta S \delta V + E_{VV} \delta V^2 \Big) - \cancel{T \delta S} + \cancel{p \delta V} \\ & = \frac{1}{2} \Big ( E_{SS} \delta S^2 + 2 E_{SV} \delta S \delta V + E_{VV} \delta V^2 \Big) ~.
        \end{aligned}
        \end{equation*}
        By imposing that $\delta^2 E > 0$, the condition to be a minimum is that 
        \begin{equation*}
            E_{SS} > 0 ~, \quad E_{VV} > 0 ~, \quad E_{SS} E_{VV} - E_{SV}^2 > 0 ~,
        \end{equation*}
        which, respectively, become, using~\eqref{td:es:e} 
        \begin{equation*}
            E_{SS} = \pdv{}{S} \underbrace{\pdv{E}{S} \Big \vert_V}_{T}  = \pdv{T}{S} \Big \vert_V > 0 ~,
        \end{equation*}
        \begin{equation*}
            E_{VV} = \pdv{}{V} \underbrace{\pdv{E}{V} \Big \vert_S}_{-p} = - \pdv{p}{V} \Big \vert_S > 0 ~,
        \end{equation*}
        \begin{equation*}
            E_{SS}E_{VV} - E^2_{SV} = - \pdv{T}{S} \Big \vert_V \pdv{p}{V} \Big \vert_S - \Big ( \pdv{p}{S} \Big \vert_V \Big )^2 = - \pdv{T}{S} \Big \vert_V \pdv{p}{V} \Big \vert_S - \Big ( \pdv{T}{V} \Big \vert_S \Big )^2 > 0 ~,
        \end{equation*}
        where we have computed, using the fact that partial derivatives commute,
        \begin{equation*}
            E_{SV} = \pdv{}{S} \Big \vert_V \underbrace{\pdv{E}{V} \Big \vert_S}_{-p} = - \pdv{p}{S} \Big \vert_V = \pdv{}{V} \Big \vert_S \underbrace{\pdv{E}{S} \Big \vert_V}_{T} = \pdv{T}{V} \Big \vert_S ~.
        \end{equation*}
    \end{proof}

\section{Specific heats and compressibilities}

    Stability conditions can be written in terms of two thermodynamic quantities that are defined as second derivatives of thermodynamic potentials: specific heat at constant volume or pressure and adiabatic or isothermal compressibility.

    Specific heat at constant volume is defined as 
    \begin{equation}\label{td:cv}
        C_V = \frac{\delta Q}{d T} \Big \vert_V = T \pdv{S}{T} \Big \vert_V ~,
    \end{equation}
    specific heat at constant pressure is defined as 
    \begin{equation}\label{td:cp}
        C_p = \frac{\delta Q}{d T} \Big \vert_p = T \pdv{S}{T} \Big \vert_p ~,
    \end{equation}
    adiabatic compressibility is defined as 
    \begin{equation*}
        \chi_S = - \frac{1}{V} \pdv{V}{p} \Big \vert_S 
    \end{equation*}
    and isothermal compressibility is defined as 
    \begin{equation}
        \chi_T = - \frac{1}{V} \pdv{V}{p} \Big \vert_T ~.
    \end{equation}
    Therefore, stability conditions can be writtes as 
    \begin{equation*}
        C_V > 0 ~, \quad C_p > 0 ~, \quad  \chi_S > 0 ~, \quad \chi_T > 0 ~.
    \end{equation*}
    \begin{proof}
        For the first, using the first of~\eqref{td:stab} and $T > 0$,
        \begin{equation*}
            C_V = T \pdv{S}{T} \Big \vert_{V} > 0 ~.
        \end{equation*}
        For the second, using the fact that $C_p > C_V > 0$.
        For the third, using the second of~\eqref{td:stab} and $V > 0$
        \begin{equation*}
            \chi_S = - \frac{1}{V} \pdv{V}{p} \Big \vert_S > 0 ~.
        \end{equation*}
        For the fourth, using the third of~\eqref{td:stab} and~\eqref{td:int:g}
        \begin{equation*}
        \begin{aligned}
            0 & < \pdv{T}{V} \Big \vert_S \pdv{T}{V} \Big \vert_S + \pdv{T}{S} \Big \vert_V \pdv{p}{V} \Big \vert_S = - \pdv{T}{V} \Big \vert_S \pdv{p}{S} \Big \vert_V + \pdv{T}{S} \Big \vert_V \pdv{p}{V} \Big \vert_S \\ & = \pdv{(T,p)}{(S,V)} = \pdv{(T,p)}{(T,V)} \pdv{(T,V)}{(S,V)} = \pdv{p}{V} \Big \vert_T \pdv{T}{S} \Big \vert_V = \frac{T}{C_V} \pdv{p}{V} \Big \vert_T ~,
        \end{aligned}
        \end{equation*}
        hence, by $T>0$, $C_V>0$ and $V>0$, 
        \begin{equation*}
            \chi_T = - \frac{1}{V} \pdv{V}{p} \Big \vert_T > 0 ~.
        \end{equation*}
    \end{proof}
    Moreover, we have the relations between the specific heats and compressibilities are
    \begin{equation*}
        \chi_T (C_P - C_V) = T V \alpha_p^2 ~, \quad C_p (\chi_T - \chi_S) = T V \alpha_p^2 ~,
    \end{equation*}
    which implies that 
    \begin{equation*}
        C_P > C_V \iff \chi_T > \chi_S ~.
    \end{equation*}
    \begin{proof}
        Using~\eqref{td:d:e}, at constant $V$, we have
        \begin{equation*}
            T dS = dE ~,
        \end{equation*}
        and at constant $p$, we have
        \begin{equation*}
            T dS = dE + p dV ~,
        \end{equation*}
        hence, we find
        \begin{equation*}
            C_V = T \pdv{S}{T} \Big \vert_V = \pdv{E}{T} \Big \vert_V ~,
        \end{equation*}
        which imply that, by isolating $TdS$,
        \begin{equation*}
            T dS = C_V dT + ( \pdv{E}{V} \Big \vert_{T} + p) dV = C_V dT + T \pdv{p}{T} \Big \vert_V dV ~,
        \end{equation*}
        and 
        \begin{equation*}
            C_p = T \pdv{S}{T} \Big \vert_p = \pdv{E}{T} \Big \vert_p + p \pdv{V}{T} \Big \vert_p  ~,
        \end{equation*}
        which implies that, by isolating $TdS$,
        \begin{equation*}
            T dS = C_p dT + ( \pdv{E}{p} \Big \vert_T + \pdv{V}{p} \Big \vert_T ) dp = C_p dT - T \pdv{V}{T} \Big \vert_p dp ~.
        \end{equation*}
        Comparing them, we find 
        \begin{equation*}
            (C_p - C_V) dT = T (\pdv{V}{T} \Big \vert_p dp + \pdv{p}{T} \Big \vert_V dV) ~,
        \end{equation*}
        which, assuming that $T(p, V)$, becomes
        \begin{equation*}
            (C_p - C_V) = T \pdv{V}{T} \Big \vert_p \pdv{p}{T} \Big \vert_V ~.
        \end{equation*}
        Now, we compute
        \begin{equation*}
            \pdv{p}{T} \Big \vert_V = \pdv{(p, V)}{(T, V)} = \pdv{(p,V)}{(p, T)} \pdv{(p, T)}{(T, V)} = - \pdv{(p,V)}{(p, T)} \pdv{(p, T)}{(V, T)} = - \pdv{V}{T} \Big \vert_p \pdv{p}{V} \Big \vert_T ~,
        \end{equation*}
        hence, we find
        \begin{equation*}
            C_p - C_V = - T \pdv{V}{T} \Big \vert_p \pdv{V}{T} \Big \vert_p \underbrace{\pdv{p}{V} \Big \vert_T}_{- \frac{1}{V \chi_T}} = \frac{T}{V \chi_T} \Big ( \pdv{V}{T} \Big \vert_p \Big)^2 ~,
        \end{equation*}
        or, equivalently,
        \begin{equation*}
            \chi_T (C_P - C_V) = T V \alpha_p^2 ~.
        \end{equation*}
        where we have defined the thermal expansion coefficient
         \begin{equation}
            \alpha_p = \frac{1}{V} \pdv{V}{T} \Big \vert_p ~.
        \end{equation}
        Moreover, using
        \begin{equation*}
            \pdv{a}{b} \Big \vert_c = \pdv{a}{b} \Big \vert_d + \pdv{a}{d} \Big \vert_b \pdv{d}{b} \Big \vert_c ~,
        \end{equation*}
        we can express $C_V$ in terms of $C_p$, using~\eqref{td:int:g} 
        \begin{equation*}
            \chi_T = - \frac{1}{V} \pdv{V}{p} \Big \vert_T = - \frac{1}{V} \pdv{V}{p} \Big \vert_S - \frac{1}{V} \pdv{V}{S} \Big \vert_p \pdv{S}{p} \Big \vert_T = \chi_S - \frac{1}{V} \pdv{V}{S} \Big \vert_p \pdv{S}{p} \Big \vert_T ~,
        \end{equation*}
        hence, we find, using the first of~\eqref{td:int:g}
        \begin{equation*}
        \begin{aligned}
            \chi_T - \chi_S & = - \frac{1}{V} \pdv{V}{S} \Big \vert_p \pdv{S}{p} \Big \vert_T = \frac{1}{V} \pdv{V}{S} \Big \vert_p \pdv{V}{T} \Big \vert_p  = \frac{1}{V} \pdv{(V, p)}{(S, p)} \pdv{(V, p)}{(T, p)}\\ &  = \frac{1}{V} \pdv{(V, p)}{(T, p)} \pdv{(T, p)}{(S, p)} \pdv{(V, p)}{(T, p)} = \frac{1}{V} \pdv{(T, p)}{(S, p)} (\pdv{(V, p)}{(T, p)})^2 \\ & = \frac{1}{V} \underbrace{\pdv{T}{S} \Big \vert_p}_{\frac{C}{C_p}} (\underbrace{\pdv{V}{T} \Big \vert_p}_{V \alpha_p})^2 = \frac{T V \alpha_p^2}{C_p} 
        \end{aligned}
        \end{equation*}
        or, equivalently,
        \begin{equation*}
            C_p (\chi_T - \chi_S) = T V \alpha_p^2 ~.
        \end{equation*}
        Finally, comparing the two expressions, we have 
        \begin{equation*}
            T V \alpha_p^2 = C_p (\chi_T - \chi_S) = \chi_T (C_p - C_T) ~,
        \end{equation*}
        \begin{equation*}
            \frac{C_p - C_V}{C_p} = 1 - \frac{C_V}{C_p} = \frac{\chi_T - \chi_S}{\chi_T} = 1 - \frac{\chi_S}{\chi_T} ~,
        \end{equation*}
        hence, we find 
        \begin{equation*}
            \frac{C_p}{C_V} = \frac{\chi_S}{\chi_T} ~.
        \end{equation*}
    \end{proof}

    In order to explicitly compute these quantities, it is useful to see that $C_V$ is 
    \begin{equation}\label{td:cv2}
        C_V = \pdv{E}{T} \Big \vert_{V, N}
    \end{equation}
    and that $C_V$ and $C_p$ are related by 
    \begin{equation}\label{td:cp2}
        C_p = C_V + p \pdv{V}{T} \Big \vert_{p, N}~.
    \end{equation}
    \begin{proof}
        For the first, at constant $V$ and $N$,~\eqref{td:d:e} becomes 
        \begin{equation*}
            dE = T dS ~,
        \end{equation*}
        hence, using~\eqref{td:cv}, we find 
        \begin{equation*}
            C_V = T \pdv{S}{T} \Big \vert_{V, N} = \pdv{E}{T} \Big \vert_{V, N} ~.
        \end{equation*}
        For the second, at constant $p$ and $N$,~\eqref{td:d:e} becomes 
        \begin{equation*}
            dE = T dS - pdV ~,
        \end{equation*}
        hence, using~\eqref{td:cp}, we find 
        \begin{equation*}
            C_p = T \pdv{S}{T} \Big \vert_{p, N} = \pdv{E}{T} \Big \vert_{V, N} + p \pdv{V}{T} \Big \vert_{p, N} = C_V + p \pdv{V}{T} \Big \vert_{p, N} ~.
        \end{equation*}
    \end{proof}

    Consequently to stability, $F$ is a concave of $T$ and convex of $V$, whereas $G$ is concave of both $T$ and $p$
    \begin{equation*}
        \pdvdu{F}{T} \Big \vert_V < 0 ~, \quad \pdvdu{F}{V} \Big \vert_T > 0 ~, \quad \pdvdu{G}{T} \Big \vert_p < 0 ~, \quad \pdvdu{G}{p} \Big \vert_T < 0 ~.
    \end{equation*}
    \begin{proof}
        For the concavity of $F$ in $T$, using the first of~\eqref{td:es:f}, we have
        \begin{equation*}
            C_V = T \pdv{S}{T} \Big \vert_{V} = - T \pdvdu{F}{T} \Big \vert_V > 0 ~,
        \end{equation*}
        hence, we find
        \begin{equation*}
            \pdvdu{F}{T} \Big \vert_V < 0 ~.
        \end{equation*}
        For the convexity of $F$ in $V$, using the second of~\eqref{td:es:f} and inverting it, we have
        \begin{equation*}
            \chi_T = - \frac{1}{V} \pdv{V}{p} \Big \vert_T = \Big ( V \pdvdu{F}{V} \Big \vert_T \Big)^{-1} > 0 ~,
        \end{equation*}
        hence, we find
        \begin{equation*}
            \pdvdu{F}{V} \Big \vert_T > 0 ~.
        \end{equation*}
        For the concavity of $G$ in $T$, using the first of~\eqref{td:es:g}, we have
        \begin{equation*}
            C_P = T \pdv{S}{T} \Big \vert_{P} = - T \pdvdu{G}{T} \Big \vert_p > 0 ~,
        \end{equation*}
        hence, we find
        \begin{equation*}
            \pdvdu{G}{T} \Big \vert_p < 0 ~.
        \end{equation*}
        For the concavity of $G$ in $p$, using the second of~\eqref{td:es:g}, we have
        \begin{equation*}
            \chi_T = - \frac{1}{V} \pdv{V}{p} \Big \vert_T = - \frac{1}{V} \pdvdu{G}{p} \Big \vert_T > 0 ~,
        \end{equation*}
        hence, we find
        \begin{equation*}
            \pdvdu{G}{p} \Big \vert_T < 0 ~.
        \end{equation*}
    \end{proof}
    Furthermore, the second law of thermodynamics~\eqref{td:2nd} can be expressed, in order to maximise entropy, by imposing that its first derivatives vanish and the hessian, i.e.~the matrix with its second derivatives, must be negative defined. Therefore, it must be (locally) concave in $E$, $V$ and $N$
    \begin{equation*}
        \pdvdu{S}{E} \Big \vert_{V, N} < 0 ~, \quad \pdvdu{S}{V} \Big \vert_{E, N} < 0 ~, \quad \pdvdu{S}{N} \Big \vert_{E, V} < 0 ~.
    \end{equation*}

    When we cease to work at constant $N$, the stability condition becomes
    \begin{equation*}
        \pdv{N}{\mu} \Big \vert_{V, T} = \frac{N^2}{V} \chi_T > 0 ~.
    \end{equation*}
    \begin{proof}
        In fact, using the second of~\eqref{td:max} and the properties of the Jacobian determinant, we obtain
        \begin{equation*}
        \begin{aligned}
            \pdv{N}{\mu} \Big \vert_{V, T} & = \pdv{(N, V, T)}{(\mu, V, T)} = \pdv{(N, V, T)}{(\mu, V, T)} \pdv{(p, V, T)}{(\mu, N, T)} = \pdv{(N, V, T)}{(N, p, T)}\pdv{(N, p, T)}{(\mu, V, T)} \pdv{(p, V, T)}{(\mu, N, T)} \\ & = \pdv{(N, V, T)}{(N, p, T)} \pdv{(N, p, T)}{(p, V, T)} \pdv{(p, V, T)}{(\mu, V, T)} \pdv{(p, V, T)}{(\mu, N, T)} = \pdv{(N, V, T)}{(N, p, T)} \pdv{(N, p, T)}{(\mu, N, T)} \pdv{(p, V, T)}{(\mu, V, T)} \\ & = - \pdv{(V, N, T)}{(p, N, T)} \pdv{(p, N, T)}{(\mu, N, T)} \pdv{(p, V, T)}{(\mu, V, T)} = - \pdv{V}{p} \Big \vert_{N, T}  \pdv{p}{\mu} \Big \vert_{V, T} \pdv{p}{\mu} \Big \vert_{N, T} ~.
        \end{aligned}
        \end{equation*}
        Now, using~\eqref{td:gd} and the fact that $\mu$ is intensive, we have
        \begin{equation*}
            \pdv{p}{\mu} \Big \vert_{V, T} = \pdv{p}{\mu} \Big \vert_{N, T} = \Big ( \pdv{\mu}{p} \Big \vert_T \Big)^{-1} = \frac{1}{v} = \frac{N}{V} ~,
        \end{equation*}
        hence, we find
        \begin{equation*}
        \pdv{N}{\mu} \Big \vert_{V, T} = - \frac{N^2}{V^2} \pdv{V}{p} \Big \vert_{N,T} = \frac{N^2}{V} \chi_T > 0 ~.
        \end{equation*}
    \end{proof}

    Finally, we find an important stability condition
    \begin{equation}\label{td:muT}
        \pdv{\mu}{T} \Big \vert_N \leq 0 ~.
    \end{equation}
    \begin{proof}
        In fact, using~\eqref{td:gd} and the second law of thermodynamic~\eqref{td:2nd}, we find 
        \begin{equation*}
            \pdv{\mu}{T} \Big \vert_{N, p} = - s \leq 0 ~.
        \end{equation*}
    \end{proof}

    